import unittest

import numpy as np
from numpy.ma.testutils import assert_array_almost_equal

from loss_functions import log_loss, sigmoid_loss


class TestCase(unittest.TestCase):
    def test_log_loss(self):
        y = np.array([[0.5, 0.5], [0.1, 0.9], [0.01, 0.99],
                      [0.9, 0.1], [0.75, 0.25], [0.001, 0.999]])
        y_loss = log_loss(y)
        y_predicted = np.array([[[0.68394851, 0.68394851],
                                 [0.92966787, 0.492181],
                                 [0.99280456, 0.45583529],
                                 [0.492181, 0.92966787],
                                 [0.55813688, 0.83090494],
                                 [0.99927883, 0.45232923]],
                                [[-0.54467605, -0.54467605],
                                 [-0.68531017, -0.41701172],
                                 [-0.71774081, -0.39084351],
                                 [-0.41701172, -0.68531017],
                                 [-0.4628473 , -0.63164579],
                                 [-0.72098685, -0.38828417]]])
        assert_array_almost_equal(y_loss, y_predicted)

    def test_sigmoid_loss(self):
        y = np.array([[0.5, 0.5], [0.1, 0.9], [0.01, 0.99],
                      [0.9, 0.1], [0.75, 0.25], [0.001, 0.999]])
        y_loss = sigmoid_loss(y)
        y_predicted = np.array([[[0.75508134, 0.75508134],
                                 [0.95004163, 0.57810099],
                                 [0.99500004, 0.54182416],
                                 [0.57810099, 0.95004163],
                                 [0.6416426, 0.875647],
                                 [0.9995, 0.53827616]],
                                [[-0.47000742, -0.47000742],
                                 [-0.49875208, -0.41100061],
                                 [-0.4999875, -0.39503745],
                                 [-0.41100061, -0.49875208],
                                 [-0.43578999, -0.49226817],
                                 [-0.49999988, -0.39340555]]])
        assert_array_almost_equal(y_loss, y_predicted)
